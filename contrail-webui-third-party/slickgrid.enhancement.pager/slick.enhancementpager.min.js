/**
* SlickGrid Enhancement Pager
*
* An easy-to-use slickgrid pager.
* https://github.com/kingleema/SlickGridEnhancementPager
* Released under the MIT license.
* 
* Copyright 2012 KingleeMa <https://github.com/kingleema>
*
*/
(function(b){function a(d){var f=parseInt(d.waiting);if(isNaN(f)){f=30000}b.ajax({url:d.remoteUrl,type:"POST",cache:false,data:{pageSize:10,pageIndex:1},dataType:"text",crossDomain:true,timeout:f,beforeSend:function(){d.container.html('<span class="dataloading">&nbsp;</span>')},error:function(g,i,h){d.container.html('<span style="position:absolute;top:5px;left:5px;color:red;">Error!&nbsp;'+h+"</span>")},success:function(h){var g=b.evalJSON(h).Total;pagecount=parseInt(Math.floor(parseFloat(g/10))+1);e(pagecount,d.pagerType,d.trans,f);c(1,d.remoteUrl,d.pagerType,d.params,f)}});function e(h,i,g,j){d.container.html("");b('<span class="perpage" title="Records count of per page"><select class="recordsperpage">              <option value="10">10</option>              <option value="25">25</option>              <option value="50">50</option>              <option value="100">100</option>          </select></span>          <span class="spacer">&nbsp;</span>          <span class="pagelabel" style="vertical-align: middle;">Page</span>          <input class="currentpage" title="Current Page" type="text" value="1" style="vertical-align: middle;width:7px" />          <span style="vertical-align: middle;">&nbsp;/&nbsp;</span>          <span id="totalpages" style="vertical-align: middle;">#</span>          <span class="spacer">&nbsp;</span>          <a id="dataloading" href="javascript:;" class="button-base-class refresh" title="Refresh"></a>		  <span class="spacer">&nbsp;</span>          <span class="recordstate"><span class="recordstatelabel">Display</span>&nbsp;<span id="recordsegment"></span>&nbsp;/&nbsp;<span id="totalrecords"></span></span>          <a href="javascript:;" class="button-base-class currentrecords" title="Show/Hide Current Records State"></a>').appendTo(d.container);b(".currentpage").keydown(function(l){if(l.keyCode==13){var k=1;if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(k)}else{k=parseInt(b(".currentpage").val());if(k<1){k=1}if(k>parseInt(b("#totalpages").text())){k=parseInt(b("#totalpages").text())}b(".currentpage").val(k)}c(k,d.remoteUrl,i,d.params,j)}});if(i=="slider"){b('<span class="button-base-class pageminus" title="Previous Page">&nbsp;</span>               <span class="pagerslider"></span>               <span class="button-base-class pageplus" title="Next Page">&nbsp;</span>               <span class="spacer">&nbsp;</span>').insertBefore(b(".pagelabel"));if(g!==null&&g!==undefined){b.each(g,function(m,l){if(m!="resultset_first"&&m!="resultset_prev"&&m!="resultset_next"&&m!="resultset_last"){if(m=="pagelabel"||m=="recordstatelabel"){b("."+m).text(l)}else{b("."+m).attr("title",l)}}})}b(".pagerslider").slider({range:"min",value:1,step:1,min:1,max:h,slide:function(l,m){b(".currentpage").css("width",m.value.toString().length*7+"px");var k=m.value;b(".currentpage").val(k)},stop:function(l,m){var k=m.value;c(k,d.remoteUrl,i,d.params,j)}});b(".pageplus").click(function(){if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(1)}var k=parseInt(b(".currentpage").val())+1;if(k>parseInt(b("#totalpages").text())){k=parseInt(b("#totalpages").text())}c(k,d.remoteUrl,i,d.params,j)});b(".pageminus").click(function(){if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(1)}var k=parseInt(b(".currentpage").val())-1;if(k<1){k=1}c(k,d.remoteUrl,i,d.params,j)})}else{b('<a href="javascript:;" class="button-base-class resultset_first" title="First Page"></a>               <a href="javascript:;" class="button-base-class resultset_prev" title="Previous Page"></a>               <span class="spacer">&nbsp;</span>').insertBefore(b(".pagelabel"));b('<span class="spacer">&nbsp;</span>               <a href="javascript:;" class="button-base-class resultset_next" title="Next Page"></a>               <a href="javascript:;" class="button-base-class resultset_last" title="Last Page"></a>').insertAfter(b("#totalpages"));if(g!==null&&g!==undefined){b.each(g,function(m,l){if(m!="pageminus"&&m!="pageplus"){if(m=="pagelabel"||m=="recordstatelabel"){b("."+m).text(l)}else{b("."+m).attr("title",l)}}})}b(".resultset_first").click(function(){var k=1;c(k,d.remoteUrl,i,d.params,j)});b(".resultset_prev").click(function(){if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(1)}var k=parseInt(b(".currentpage").val())-1;if(k<1){k=1}c(k,d.remoteUrl,i,d.params,j)});b(".resultset_next").click(function(){if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(1)}var k=parseInt(b(".currentpage").val())+1;if(k>parseInt(b("#totalpages").text())){k=parseInt(b("#totalpages").text())}c(k,d.remoteUrl,i,d.params,j)});b(".resultset_last").click(function(){var k=parseInt(b("#totalpages").text());c(k,d.remoteUrl,i,d.params,j)})}b(".recordsperpage").dropkick({change:function(m,l){var k=1;c(k,d.remoteUrl,i,d.params,j)}});b(".refresh").click(function(){if(isNaN(parseInt(b(".currentpage").val()))){b(".currentpage").val(1)}var k=parseInt(b(".currentpage").val());if(k<1){k=1}if(k>parseInt(b("#totalpages").text())){k=parseInt(b("#totalpages").text())}c(k,d.remoteUrl,i,d.params,j)});b(".currentrecords").click(function(){b(".recordstate").toggle("fast")})}function c(h,i,m,l,n){var j=b(".recordsperpage").val();var k=h;var g={};g.pageSize=j;g.pageIndex=k;if(l!==null&&l!=undefined){b.each(l,function(p,o){g[p]=b(o).val()})}b.ajax({url:i,type:"POST",cache:false,dataType:"text",crossDomain:true,data:g,timeout:n,beforeSend:function(){b("#dataloading").attr("disabled","disabled");b("#dataloading").removeClass("refresh");b("#dataloading").addClass("dataloading")},error:function(o,q,p){d.container.html('<span style="position:absolute;top:5px;left:5px;color:red;">Error!&nbsp;'+p+"</span>")},success:function(u){var s=b.evalJSON(u).Total;var t=b.evalJSON(b.evalJSON(u).Rows);d.datagrid.setData(t);d.datagrid.render();b(".currentpage").css("width",h.toString().length*7+"px");b(".currentpage").val(h);var v=h;var q=parseInt(b(".recordsperpage").val());var p=(v-1)*q+1;var r=p+q-1;if(r>s){r=s}b("#recordsegment").text(p+"-"+r);b("#totalrecords").text(s);var o=parseInt(Math.floor(parseFloat(s/q))+1);b("#totalpages").text(o);if(m=="slider"){b(".pagerslider").slider("value",h);b(".pagerslider").slider("option","max",o)}b("#dataloading").removeAttr("disabled");b("#dataloading").removeClass("dataloading");b("#dataloading").addClass("refresh")}})}}b.extend(true,window,{Slick:{Controls:{EnhancementPager:a}}})})(jQuery);